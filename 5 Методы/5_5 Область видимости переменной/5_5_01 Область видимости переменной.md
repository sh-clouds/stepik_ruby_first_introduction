Область видимости переменной

Область видимости определяет, где в программе доступна переменная.

В Ruby есть четыре типа области видимости переменных: локальная (local), глобальная (global), экземпляр (instance) и класс (class).

Локальные переменные являются локальными для конструкции кода, в которой они объявлены. Например, локальная переменная, объявленная в методе или внутри блока (do ... end или { ... }), будет недоступна вне этого метода или блока. Например:

def calc(x)
  y = 2
  puts x * y
end

                  
В приведенном выше коде x и y являются локальными переменными. Они доступны только внутри метода calc.
Если мы попытаемся получить доступ к ним вне метода, то получим ошибку:

def calc(x)
  y = 2
  puts x * y
end

puts y
# выведет: undefined local variable or method 'y'

                  
То же самое относится к итераторам:

arr = [1, 2, 3]
arr.each {|x| puts x}

                  
x - локальная переменная, доступная только в итерационном блоке.

Обратите внимание, что вы можете иметь разные переменные с одним и тем же именем в разных областях видимости. Но это будут РАЗНЫЕ переменные. Поэтому, чтобы не запутаться, так лучше не делать. Но знать об этом нужно.